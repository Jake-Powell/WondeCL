% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pull_functions.R
\name{get_query}
\alias{get_query}
\title{Pull from Wonde API (with error handling)}
\usage{
get_query(url_path, filter = "", KEY = "")
}
\arguments{
\item{url_path}{The API endpoint to query.}

\item{filter}{Additional parameters to include in the request (e.g., `&include=groups`).}

\item{KEY}{The Wonde API access token.}
}
\value{
A combined `data.frame` of the pulled information if data are returned,
otherwise `NULL` if the endpoint cannot be accessed or contains no records.
}
\description{
Safely queries a Wonde API endpoint, handling pagination, authentication, and
potential access or parsing errors. If an endpoint is inaccessible or returns
no data (e.g., 0 rows Ã— 0 columns), the function returns `NULL` instead of
stopping execution.
}
\details{
The function automatically paginates through all available pages of results
and concatenates them into a single data frame using `rbind_aggro()`.

If the endpoint is inaccessible (e.g., insufficient permissions, invalid ID)
or returns an empty result, `NULL` is returned so that downstream code can
gracefully skip processing.
}
\examples{
\dontshow{if (FALSE) withAutoprint(\{ # examplesIf}
school_id <- "Enter_ID_here"
KEY <- "Enter_KEY_here"

# Employee information
url_path <- paste0("https://api.wonde.com/v1.0/schools/", school_id, "/employees/")
employees <- get_query(url_path, filter = '&include=groups', KEY = KEY)

if (!is.null(employees)) {
  employees_groups <- employees |>
    convert_list_element_to_df(column_to_unnest = 'groups.data') |>
    tidyr::unnest(groups.data, names_sep = '__', keep_empty = TRUE)
}
\dontshow{\}) # examplesIf}
}
\seealso{
[httr2::req_perform()], [jsonlite::fromJSON()]
}
